/*
    * smartresize: debounced resize event for jQuery
    *
    * latest version and complete README available on Github:
    * https://github.com/louisremi/jquery.smartresize.js
    *
    * Copyright 2011 @louis_remi
    * Licensed under the MIT license.
    */
   !function(t,e){var a,i=e.event;i.special.smartresize={setup:function(){e(this).bind("resize",i.special.smartresize.handler)},teardown:function(){e(this).unbind("resize",i.special.smartresize.handler)},handler:function(t,e){var i=this,s=arguments;t.type="smartresize",a&&clearTimeout(a),a=setTimeout(function(){jQuery.event.handle.apply(i,s)},"execAsap"===e?0:100)}},e.fn.smartresize=function(t){return t?this.bind("smartresize",t):this.trigger("smartresize",["execAsap"])},e.Slideshow=function(t,a){this.$el=e(a),this.$list=this.$el.find("ul.ei-slider-large"),this.$imgItems=this.$list.children("li"),this.itemsCount=this.$imgItems.length,this.$images=this.$imgItems.find("img:first"),this.$sliderthumbs=this.$el.find("ul.ei-slider-thumbs").hide(),this.$sliderElems=this.$sliderthumbs.children("li"),this.$sliderElem=this.$sliderthumbs.children("li.ei-slider-element"),this.$thumbs=this.$sliderElems.not(".ei-slider-element"),this._init(t)},e.Slideshow.defaults={animation:"sides",autoplay:!1,slideshow_interval:3e3,speed:800,easing:"",titlesFactor:.6,titlespeed:800,titleeasing:"",thumbMaxWidth:150},e.Slideshow.prototype={_init:function(t){this.options=e.extend(!0,{},e.Slideshow.defaults,t),this.$imgItems.css("opacity",0),this.$imgItems.find("div.ei-title > *").css("opacity",0),this.current=0;var a=this;this.$loading=e('<div class="ei-slider-loading">Loading</div>').prependTo(a.$el),e.when(this._preloadImages()).done(function(){a.$loading.hide(),a._setImagesSize(),a._initThumbs(),a.$imgItems.eq(a.current).css({opacity:1,"z-index":10}).show().find("div.ei-title > *").css("opacity",1),a.options.autoplay&&a._startSlideshow(),a._initEvents()})},_preloadImages:function(){var t=this,a=0;return e.Deferred(function(i){t.$images.each(function(){e("<img/>").load(function(){++a===t.itemsCount&&i.resolve()}).attr("src",e(this).attr("src"))})}).promise()},_setImagesSize:function(){this.elWidth=this.$el.width();var t=this;this.$images.each(function(){var a=e(this);imgDim=t._getImageDim(a.attr("src")),a.css({width:imgDim.width,height:imgDim.height,marginLeft:imgDim.left,marginTop:imgDim.top})})},_getImageDim:function(t){var e=new Image;e.src=t;var a,i,s=this.elWidth,n=this.$el.height(),r=n/s,o=e.width,l=e.height,d=l/o;return r>d?(i=n,a=n/d):(i=s*d,a=s),{width:a,height:i,left:(s-a)/2,top:(n-i)/2}},_initThumbs:function(){this.$sliderElems.css({"max-width":this.options.thumbMaxWidth+"px",width:100/this.itemsCount+"%"}),this.$sliderthumbs.css("max-width",this.options.thumbMaxWidth*this.itemsCount+"px").show()},_startSlideshow:function(){var t=this;this.slideshow=setTimeout(function(){var e;e=t.current===t.itemsCount-1?0:t.current+1,t._slideTo(e),t.options.autoplay&&t._startSlideshow()},this.options.slideshow_interval)},_slideTo:function(t){if(t===this.current||this.isAnimating)return!1;this.isAnimating=!0;var a=this.$imgItems.eq(this.current),i=this.$imgItems.eq(t),s=this,n={zIndex:10},r={opacity:1};"sides"===this.options.animation&&(n.left=t>this.current?-1*this.elWidth:this.elWidth,r.left=0),i.find("div.ei-title > h2").css("margin-right","50px").stop().delay(this.options.speed*this.options.titlesFactor).animate({marginRight:"0px",opacity:1},this.options.titlespeed,this.options.titleeasing).end().find("div.ei-title > h3").css("margin-right","-50px").stop().delay(this.options.speed*this.options.titlesFactor).animate({marginRight:"0px",opacity:1},this.options.titlespeed,this.options.titleeasing),e.when(a.css("z-index",1).find("div.ei-title > *").stop().fadeOut(this.options.speed/2,function(){e(this).show().css("opacity",0)}),i.css(n).stop().animate(r,this.options.speed,this.options.easing),this.$sliderElem.stop().animate({left:this.$thumbs.eq(t).position().left},this.options.speed)).done(function(){a.css("opacity",0).find("div.ei-title > *").css("opacity",0),s.current=t,s.isAnimating=!1})},_initEvents:function(){var a=this;e(t).on("smartresize.eislideshow",function(){a._setImagesSize(),a.$sliderElem.css("left",a.$thumbs.eq(a.current).position().left)}),this.$thumbs.on("click.eislideshow",function(){a.options.autoplay&&(clearTimeout(a.slideshow),a.options.autoplay=!1);var t=e(this),i=t.index()-1;return a._slideTo(i),!1})}};var s=function(t){this.console};e.fn.eislideshow=function(t){if("string"==typeof t){var a=Array.prototype.slice.call(arguments,1);this.each(function(){var i=e.data(this,"eislideshow");return i?e.isFunction(i[t])&&"_"!==t.charAt(0)?void i[t].apply(i,a):void s("no such method '"+t+"' for eislideshow instance"):void s("cannot call methods on eislideshow prior to initialization; attempted to call method '"+t+"'")})}else this.each(function(){var a=e.data(this,"eislideshow");a||e.data(this,"eislideshow",new e.Slideshow(t,this))});return this}}(window,jQuery);
